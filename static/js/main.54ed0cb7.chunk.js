(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{163:function(t,e,r){t.exports=r(254)},168:function(t,e,r){},169:function(t,e,r){},254:function(t,e,r){"use strict";r.r(e);var s,n=r(0),i=r.n(n),o=r(25),a=r.n(o),l=(r(168),r(9)),c=r(7),u=r(21),h=r(20),f=r(22);r(169);!function(t){t.BLACK="blackSquare",t.WHITE="whiteSquare",t.ACTIVE="highlightSquare"}(s||(s={}));var g=function(t){function e(t){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).call(this,t))}return Object(f.a)(e,t),Object(c.a)(e,[{key:"pointToIdString",value:function(t){return t+this.props.coords.x+"-"+this.props.coords.y}}]),Object(c.a)(e,[{key:"render",value:function(){var t=[];return t.push(i.a.createElement("rect",{key:this.pointToIdString("box"),x:40*this.props.coords.x,y:40*this.props.coords.y,width:40,height:40,className:this.props.fillType})),this.props.fillType&&(t.push(i.a.createElement("text",{key:this.pointToIdString("text"),x:40*(this.props.coords.x+.35),y:40*(this.props.coords.y+.65),className:"clueText"},this.props.letter)),""!=this.props.clueNumber&&t.push(i.a.createElement("text",{key:this.pointToIdString("clue"),x:40*this.props.coords.x+2,y:40*this.props.coords.y+10,className:"clueNumber"},this.props.clueNumber))),i.a.createElement("g",{key:this.pointToIdString("group")},t)}}]),e}(n.Component),d=r(26),v=r(33),y=r.n(v),p=function(){function t(e){Object(l.a)(this,t),this.clueNumber=void 0,this.start=void 0,this.length=void 0,this.isAcross=void 0,this.state=void 0,this.clueNumber=e.clueNumber,this.start=e.start,this.length=e.length,this.isAcross=e.isAcross;var r=Array(e.length+1).join(".");this.state={isBacktracking:!1,isFilled:!1,constraints:r,intersectingClues:[]}}return Object(c.a)(t,[{key:"lengthen",value:function(){this.length++,this.state.constraints+="."}},{key:"getPoints",value:function(){for(var t=[],e=0;e<this.length;e++)this.isAcross?t.push({x:this.start.x+e,y:this.start.y}):t.push({x:this.start.x,y:this.start.y+e});return t}},{key:"contains",value:function(t){return this.isAcross?t.y==this.start.y&&this.start.x<=t.x&&t.x<this.start.x+this.length:t.x==this.start.x&&this.start.y<=t.y&&t.y<this.start.y+this.length}},{key:"intersects",value:function(t){if(t.isAcross==this.isAcross)return null;var e=t.isAcross?t:this,r=t.isAcross?this:t,s={x:r.start.x,y:e.start.y};return e.contains(s)&&r.contains(s)?s:null}},{key:"setConstraint",value:function(t,e){if(1!=e.length||t>=this.state.constraints.length)throw new Error("chr length must be 1 and "+t+" < "+this.state.constraints.length+" -- "+this.start.x+","+this.start.y+"("+this.length+")"+(this.isAcross?"A":"D"));var r=this.state.constraints;r.length;this.state.constraints=r.substr(0,t)+e+r.substr(t+1)}}]),t}();function x(t){var e=t.length,r=[],n=null;function i(i,o,a){if(i==e||o==e)return null!=n&&r.push(n),void(n=null);t[i][o].fillType!=s.BLACK?null==n?n=new p({start:{x:o,y:i},isAcross:a,length:1,clueNumber:0}):n.lengthen():(null!=n&&r.push(n),n=null)}for(var o=0;o<e;o++)for(var a=0;a<e;a++)t[o][a].clueNumber="";for(o=0;o<e;o++)for(a=0;a<e+1;a++)i(o,a,!0);for(o=0;o<e;o++)for(a=0;a<e+1;a++)i(a,o,!1);var l=r.filter(function(t){return 1==t.length});t.forEach(function(t){return t.forEach(function(t){2==l.filter(function(e){return e.start.x==t.coords.x&&e.start.y==t.coords.y}).length&&(t.fillType=s.BLACK)})});for(var c=r.filter(function(t){return t.length>1}).sort(function(t,r){return t.start.x+e*t.start.y-r.start.x-r.start.y*e}),u=0,h=0;h<c.length;h++){var f=c[h];""==t[f.start.y][f.start.x].clueNumber&&(u++,t[f.start.y][f.start.x].clueNumber=""+u),f.clueNumber=u}return c}var b=r(61);function m(t){for(var e=0;e<t.length;e++)for(var r=t[e],s=0;s<r.state.intersectingClues.length;s++){var n=r.state.intersectingClues[s];if(r.state.isFilled||n.state.isFilled){var i=r.isAcross?r:n,o=r.isAcross?n:r,a=i.state.constraints.charAt(o.start.x-i.start.x),l=o.state.constraints.charAt(i.start.y-o.start.y);if(i.state.isFilled||i.setConstraint(o.start.x-i.start.x,l),o.state.isFilled||o.setConstraint(i.start.y-o.start.y,a),i.state.isFilled&&o.state.isFilled&&a!=l)return!1}}return!0}function A(t){return function(t){console.log("InBacktr");for(var e=0;e<t.length;e++)t[e].state.constraints=Array(t[e].length+1).join(" "),t[e].state.isBacktracking=!0,t[e].state.isFilled=!1,t[e].state.intersectingClues=[];for(var r=0;r<t.length;r++)for(var s=r+1;s<t.length;s++){var n=t[r],i=t[s];if(!n.state||!i.state)throw Error("Just set above");n.intersects(i)&&(n.state.intersectingClues.push(i),i.state.intersectingClues.push(n))}}(t),function t(e,r){var s=e.filter(function(t){return t.state.isFilled}).length;console.log("Solved "+s+" of "+e.length);var n=e.filter(function(t){return!t.state.isFilled});if(0==n.length)return e;for(var i=0;i<n.length;i++){var o=n[i],a=C(o,r,0);if(null==a)return null}for(var l=0;l<n.length;l++)for(var c=n[l],u=C(c,r,0);null!=u;){r.add(u.word),c.state.constraints=u.word,c.state.isFilled=!0;var h=t(e,r);if(null!=h)return h;c.state.isFilled=!1,r.delete(u.word),m(e),u=C(c,r,u.index+1)}return null}(t,new Set)}var E,k=["AAAAA","ABBBB","ACCCC","ADDDD","BXCXD","BYCYD","BX","XD","BB","AB"];function C(t,e,r){for(var s=r;s<k.length;s++)if(!e.has(k[s])&&k[s].length==t.length&&w(t.state.constraints,k[s]))return{index:s,word:k[s]};return null}function w(t,e){for(var r=0;r<t.length;r++)if(" "!=t.charAt(r)&&t.charAt(r)!=e.charAt(r))return!1;return!0}function I(t,e){return t%2==1&&e%2==1?s.BLACK:s.WHITE}!function(t){t.SOLVE="SOLVE",t.GRID="GRID"}(E||(E={}));var T=5;function N(t){var e=Object(d.cloneDeep)(t);return e.forEach(function(t){return t.forEach(function(t){t.fillType==s.ACTIVE&&(t.fillType=s.WHITE)})}),e}var B=function(t){function e(t){var r;Object(l.a)(this,e),(r=Object(u.a)(this,Object(h.a)(e).call(this,t))).nameInput=void 0,r.div=void 0,t.editable||console.log("To implmenet loading crossword later");for(var s=[],n=0;n<T;n++){for(var i=[],o=0;o<T;o++)i.push({fillType:I(n,o),letter:"",coords:{y:n,x:o},clueNumber:""});s.push(i)}return r.state={boxes:s,clues:x(s),cursor:{x:-1,y:-1},mode:E.SOLVE,isAcross:!0},r}return Object(f.a)(e,t),Object(c.a)(e,[{key:"onClick",value:function(t){var e=this,r=Object(d.floor)(T*t.clientX/t.currentTarget.clientWidth),n=Object(d.floor)(T*t.clientY/t.currentTarget.clientHeight),i={x:r,y:n};this.setState(function(t){var o=t.clues,a=N(t.boxes),l=t.isAcross;return t.mode==E.GRID?(a[n][r].fillType==s.BLACK?a[n][r].fillType=s.WHITE:a[n][r].fillType=s.BLACK,o=x(a)):l=e.trySetIsAcrossAndHighlight(a,o,t.isAcross,i),{boxes:a,cursor:i,clues:o,isAcross:l}}),this.nameInput&&this.nameInput.focus()}},{key:"trySetIsAcrossAndHighlight",value:function(t,e,r,n){var i=e.filter(function(t){return t.contains(n)});if(i.length>2)throw new Error("Should not be possible");if(2==i.length)i.filter(function(t){return t.isAcross==r})[0].getPoints().forEach(function(e){t[e.y][e.x].fillType=s.ACTIVE});else if(1==i.length){var o=i[0];r=o.isAcross,o.getPoints().forEach(function(e){t[e.y][e.x].fillType=s.ACTIVE})}else console.log("No clues at this point");return r}},{key:"getNextPoint",value:function(t){return t.x<0||t.y<0?t:this.state.isAcross?t.x<T-1?{x:t.x+1,y:t.y}:t:t.y<T-1?{x:t.x,y:t.y+1}:t}},{key:"onToggleChange",value:function(t){var e=t.currentTarget.checked?E.GRID:E.SOLVE;this.setState(function(t){return{mode:e,boxes:N(t.boxes)}})}},{key:"onInputBoxChange",value:function(){var t=this,e=this.state.cursor.x,r=this.state.cursor.y;if(e<0||r<0||this.state.boxes[r][e].fillType==s.BLACK||!this.nameInput)console.log("Ignoring changeEvent");else{var n=this.nameInput.value;(n=n.toUpperCase())>"Z"||n<"A"?console.log("Ignoring key "+n):this.setState(function(e){var r=Object(d.cloneDeep)(e.boxes);return r[e.cursor.y][e.cursor.x].letter=n,{boxes:r,cursor:t.getNextPoint(e.cursor)}})}}}]),Object(c.a)(e,[{key:"getHiddenBoxStyle",value:function(){if(!this.div||this.state.mode==E.GRID)return{visibility:"collapse"};var t=this.div.clientWidth;return{left:t*(this.state.cursor.x/T),top:t*(this.state.cursor.y/T),width:t/T,height:t/T,position:"absolute",background:"transparent",border:"none",textAlign:"center"}}},{key:"hideIfNotEditable",value:function(){return this.props.editable?{visibility:"visible"}:{visibility:"collapse"}}},{key:"render",value:function(){var t=this;return console.log("Render Crossword"),i.a.createElement("div",{ref:function(e){t.div=e},className:"crossword",tabIndex:0},i.a.createElement("svg",{onClick:function(e){return t.onClick(e)},id:"crossword-svg",viewBox:"0 0 "+40*T+" "+40*T,xmlns:"http://www.w3.org/2000/svg"},this.state.boxes.map(function(t){return t.map(function(t){return i.a.createElement(g,{key:t.coords.x+"-"+t.coords.y,fillType:t.fillType,coords:t.coords,letter:t.letter,clueNumber:t.clueNumber})})})),i.a.createElement("div",{style:this.hideIfNotEditable()},"Edit Grid",i.a.createElement(y.a,{value:"Edit",onChange:function(e){return t.onToggleChange(e)}}),i.a.createElement(b.a,{onClick:function(e){return t.onFillButtonClick(e)}},"Fill")),i.a.createElement("input",{value:"",ref:function(e){t.nameInput=e},maxLength:1,onClick:function(e){t.setState(function(e){var r=N(e.boxes);return{isAcross:t.trySetIsAcrossAndHighlight(r,e.clues,!e.isAcross,e.cursor),boxes:r}})},onChange:function(e){return t.onInputBoxChange()},style:this.getHiddenBoxStyle()}),i.a.createElement("div",null,"Across",i.a.createElement("ul",{className:"clueList"},this.state.clues.filter(function(t){return t.isAcross}).map(function(t){return i.a.createElement("li",{key:t.clueNumber+" "+t.isAcross},t.clueNumber,". ",t.state.constraints," (",t.length,")")}))),i.a.createElement("div",null,"Down",i.a.createElement("ul",{className:"clueList"},this.state.clues.filter(function(t){return!t.isAcross}).map(function(t){return i.a.createElement("li",{key:t.clueNumber+" "+t.isAcross},t.clueNumber,". ",t.state.constraints," (",t.length,")")}))))}},{key:"onFillButtonClick",value:function(t){var e=A(this.state.clues);if(null!=e){for(var r=e,s=N(this.state.boxes),n=0;n<T;n++)for(var i=0;i<T;i++)s[n][i].letter="";e.forEach(function(t){for(var e=0;e<t.length;e++)t.state.isFilled&&(t.isAcross?s[t.start.y][t.start.x+e].letter=t.state.constraints.charAt(e):s[t.start.y+e][t.start.x].letter=t.state.constraints.charAt(e))}),this.setState(function(t){return{boxes:s,clues:r}})}else console.log("No solution!")}}]),e}(n.Component),O=function(t){function e(){return Object(l.a)(this,e),Object(u.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"container"},i.a.createElement(B,{editable:!0}))}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(i.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[163,1,2]]]);
//# sourceMappingURL=main.54ed0cb7.chunk.js.map